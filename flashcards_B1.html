<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-m">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cartes M√©moire - Fran√ßais B1 (avec Audio)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Warm Neutrals (bg-amber-50, text-stone-800, card-white, accent-amber-500) -->
    <!-- Application Structure Plan: A single-page flashcard application. The core structure features a main header, a control bar (category filter dropdown, shuffle button), the interactive flashcard area (clickable to flip), and navigation controls (previous, flip, next) with a progress indicator. The card front now integrates a play button for TTS audio, which is fetched on demand and cached. This structure is chosen for optimal usability and leverages TTS to address the user's request for pronunciation, ensuring the audio functionality doesn't slow down initial load time. -->
    <!-- Visualization & Content Choices: Report Info: 200 B1 French Words + Audio Pronunciation. Goal: Learn/Review Vocabulary, context, and pronunciation. Presentation Method: Interactive HTML/CSS/JS flashcard (div with 3D flip effect) + Dynamic Audio Playback (TTS API). Interaction: Click card to flip; play button to hear pronunciation (fetches audio via gemini-2.5-flash-preview-tts); navigation buttons (next/prev) to change cards; dropdown to filter deck. Justification: TTS is the most effective way to provide accurate pronunciation for all words on demand. Library/Method: Vanilla JS for state, DOM, and TTS API management (including PCM to WAV conversion and caching); Tailwind CSS for layout and styling. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .flashcard-container {
            perspective: 1000px;
        }
        .flashcard {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }
        .flashcard-container.is-flipped .flashcard {
            transform: rotateY(180deg);
        }
        .flashcard-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .flashcard-front {
            background-color: white;
            color: #292524;
        }
        .flashcard-back {
            background-color: #f5f5f4;
            color: #292524;
            transform: rotateY(180deg);
            justify-content: space-around;
            text-align: center;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-amber-50 text-stone-800 min-h-screen flex items-center justify-center p-4">

    <main class="w-full max-w-2xl mx-auto p-6 bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl">
        <header class="text-center mb-6">
            <h1 class="text-3xl font-bold text-amber-900">Vocabulaire Fran√ßais B1</h1>
            <p class="text-lg text-stone-600">200 mots essentiels √† ma√Ætriser</p>
        </header>

        <section class="controls mb-4 flex flex-col sm:flex-row justify-between items-center gap-4">
            <div class="w-full sm:w-auto">
                <label for="category-select" class="sr-only">Cat√©gorie</label>
                <select id="category-select" class="w-full sm:w-auto p-2 border border-stone-300 rounded-lg shadow-sm focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition">
                    <option value="all">Toutes les cat√©gories (200)</option>
                    <option value="cat1">Verbes (Action) (20)</option>
                    <option value="cat2">Verbes (Pens√©e) (20)</option>
                    <option value="cat3">Noms (Personnes/Soci√©t√©) (20)</option>
                    <option value="cat4">Noms (Objets/Lieux) (20)</option>
                    <option value="cat5">Noms (Concepts/Id√©es) (20)</option>
                    <option value="cat6">Adjectifs (Description) (20)</option>
                    <option value="cat7">Adjectifs (Opinion) (20)</option>
                    <option value="cat8">Adverbes & Intensit√© (20)</option>
                    <option value="cat9">Connecteurs & Pr√©positions (20)</option>
                    <option value="cat10">Environnement & Tech (20)</option>
                </select>
            </div>
            <button id="shuffle-button" class="w-full sm:w-auto px-4 py-2 bg-amber-500 text-white font-semibold rounded-lg shadow-md hover:bg-amber-600 transition duration-200">
                M√©langer
            </button>
        </section>

        <section class="flashcard-section mb-4">
            <p id="progress-indicator" class="text-center text-stone-500 mb-2">Carte 1 sur 200</p>
            <div id="flashcard-container" class="flashcard-container w-full h-80 sm:h-96" onclick="handleCardClick(event)">
                <div class="flashcard">
                    <div class="flashcard-face flashcard-front">
                        <div class="flex items-center justify-center gap-4">
                            <h2 id="card-front-text" class="text-4xl font-bold text-center"></h2>
                            <button id="play-button" class="text-3xl text-amber-600 hover:text-amber-700 transition disabled:opacity-50" aria-label="√âcouter la prononciation" onclick="playCurrentWord(event)">
                                üîä
                            </button>
                        </div>
                        <p id="loading-indicator" class="text-sm text-stone-500 mt-2 hidden">Chargement...</p>
                    </div>
                    <div class="flashcard-face flashcard-back p-6 flex flex-col justify-around">
                        <div>
                            <h3 id="card-back-text" class="text-3xl font-semibold"></h3>
                            <p id="card-type-text" class="text-xl text-stone-600 italic mt-1"></p>
                        </div>
                        <div class="mt-4">
                            <p id="example-fr" class="text-lg italic text-amber-800"></p>
                            <p id="example-en" class="text-sm text-stone-500 mt-1"></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <nav class="navigation-controls grid grid-cols-3 gap-4">
            <button id="prev-button" class="px-5 py-3 bg-stone-200 text-stone-700 font-semibold rounded-lg shadow-md hover:bg-stone-300 transition duration-200">
                Pr√©c√©dent
            </button>
            <button id="flip-button" class="px-5 py-3 bg-amber-500 text-white font-semibold rounded-lg shadow-md hover:bg-amber-600 transition duration-200">
                Retourner
            </button>
            <button id="next-button" class="px-5 py-3 bg-stone-200 text-stone-700 font-semibold rounded-lg shadow-md hover:bg-stone-300 transition duration-200">
                Suivant
            </button>
        </nav>
    </main>

    <script>
        const masterDeck = [
            { french: "agir", english: "to act", type: "v.", category: "cat1", example_fr: "Il est temps d'agir pour prot√©ger l'environnement.", example_en: "It is time to act to protect the environment.", audioUrl: null },
            { french: "atteindre", english: "to reach, achieve", type: "v.", category: "cat1", example_fr: "Nous devons travailler dur pour atteindre nos objectifs.", example_en: "We must work hard to reach our objectives.", audioUrl: null },
            { french: "augmenter", english: "to increase", type: "v.", category: "cat1", example_fr: "Les prix de l'essence continuent d'augmenter.", example_en: "Gas prices continue to increase.", audioUrl: null },
            { french: "baisser", english: "to decrease, lower", type: "v.", category: "cat1", example_fr: "Le gouvernement a d√©cid√© de baisser les imp√¥ts.", example_en: "The government decided to lower taxes.", audioUrl: null },
            { french: "construire", english: "to build", type: "v.", category: "cat1", example_fr: "Ils vont construire une nouvelle √©cole dans le quartier.", example_en: "They are going to build a new school in the neighborhood.", audioUrl: null },
            { french: "courir", english: "to run", type: "v.", category: "cat1", example_fr: "J'aime courir tous les matins avant le travail.", example_en: "I like to run every morning before work.", audioUrl: null },
            { french: "cr√©er", english: "to create", type: "v.", category: "cat1", example_fr: "Elle a cr√©√© une entreprise de z√©ro il y a deux ans.", example_en: "She created a company from scratch two years ago.", audioUrl: null },
            { french: "d√©velopper", english: "to develop", type: "v.", category: "cat1", example_fr: "Il faut d√©velopper de nouvelles strat√©gies commerciales.", example_en: "We must develop new business strategies.", audioUrl: null },
            { french: "devenir", english: "to become", type: "v.", category: "cat1", example_fr: "Mon r√™ve est de devenir m√©decin.", example_en: "My dream is to become a doctor.", audioUrl: null },
            { french: "diriger", english: "to direct, lead", type: "v.", category: "cat1", example_fr: "C'est lui qui dirige l'√©quipe de recherche.", example_en: "He is the one who leads the research team.", audioUrl: null },
            { french: "durer", english: "to last", type: "v.", category: "cat1", example_fr: "La r√©union a dur√© plus de trois heures.", example_en: "The meeting lasted more than three hours.", audioUrl: null },
            { french: "emp√™cher", english: "to prevent", type: "v.", category: "cat1", example_fr: "La pluie l'a emp√™ch√© de sortir.", example_en: "The rain prevented him from going out.", audioUrl: null },
            { french: "√©viter", english: "to avoid", type: "v.", category: "cat1", example_fr: "Nous devrions √©viter de parler de politique.", example_en: "We should avoid talking about politics.", audioUrl: null },
            { french: "g√©rer", english: "to manage", type: "v.", category: "cat1", example_fr: "Elle est tr√®s dou√©e pour g√©rer les crises.", example_en: "She is very good at managing crises.", audioUrl: null },
            { french: "lancer", english: "to launch, throw", type: "v.", category: "cat1", example_fr: "L'entreprise va lancer un nouveau produit le mois prochain.", example_en: "The company is going to launch a new product next month.", audioUrl: null },
            { french: "maintenir", english: "to maintain", type: "v.", category: "cat1", example_fr: "Il est difficile de maintenir l'ordre sans autorit√©.", example_en: "It is difficult to maintain order without authority.", audioUrl: null },
            { french: "obtenir", english: "to obtain", type: "v.", category: "cat1", example_fr: "J'ai obtenu mon dipl√¥me l'ann√©e derni√®re.", example_en: "I obtained my diploma last year.", audioUrl: null },
            { french: "permettre", english: "to allow, permit", type: "v.", category: "cat1", example_fr: "Ce nouveau syst√®me permet un acc√®s plus rapide aux donn√©es.", example_en: "This new system allows faster access to data.", audioUrl: null },
            { french: "produire", english: "to produce", type: "v.", category: "cat1", example_fr: "Cette usine produit des pi√®ces automobiles.", example_en: "This factory produces car parts.", audioUrl: null },
            { french: "proposer", english: "to propose, suggest", type: "v.", category: "cat1", example_fr: "Je peux vous proposer une autre solution.", example_en: "I can propose another solution to you.", audioUrl: null },
            
            { french: "accepter", english: "to accept", type: "v.", category: "cat2", example_fr: "Il a accept√© la proposition sans h√©siter.", example_en: "He accepted the proposal without hesitation.", audioUrl: null },
            { french: "affirmer", english: "to affirm, state", type: "v.", category: "cat2", example_fr: "Il affirme qu'il a toujours dit la v√©rit√©.", example_en: "He states that he has always told the truth.", audioUrl: null },
            { french: "ajouter", english: "to add", type: "v.", category: "cat2", example_fr: "Voulez-vous ajouter du sucre √† votre caf√©?", example_en: "Do you want to add sugar to your coffee?", audioUrl: null },
            { french: "annoncer", english: "to announce", type: "v.", category: "cat2", example_fr: "La m√©t√©o annonce de la neige pour demain.", example_en: "The weather forecast announces snow for tomorrow.", audioUrl: null },
            { french: "appartenir (√†)", english: "to belong (to)", type: "v.", category: "cat2", example_fr: "Ce livre appartient √† la biblioth√®que municipale.", example_en: "This book belongs to the municipal library.", audioUrl: null },
            { french: "avertir", english: "to warn", type: "v.", category: "cat2", example_fr: "Nous avons averti l'√©quipe du danger potentiel.", example_en: "We warned the team of the potential danger.", audioUrl: null },
            { french: "consid√©rer", english: "to consider", type: "v.", category: "cat2", example_fr: "Je consid√®re cette t√¢che comme une priorit√©.", example_en: "I consider this task a priority.", audioUrl: null },
            { french: "convaincre", english: "to convince", type: "v.", category: "cat2", example_fr: "Elle a r√©ussi √† me convaincre de son innocence.", example_en: "She managed to convince me of her innocence.", audioUrl: null },
            { french: "craindre", english: "to fear", type: "v.", category: "cat2", example_fr: "Beaucoup de gens craignent les cons√©quences du changement climatique.", example_en: "Many people fear the consequences of climate change.", audioUrl: null },
            { french: "d√©cider (de)", english: "to decide (to)", type: "v.", category: "cat2", example_fr: "Elle a d√©cid√© de d√©missionner la semaine prochaine.", example_en: "She decided to resign next week.", audioUrl: null },
            { french: "esp√©rer", english: "to hope", type: "v.", category: "cat2", example_fr: "J'esp√®re que tout ira bien pour toi.", example_en: "I hope that everything goes well for you.", audioUrl: null },
            { french: "expliquer", english: "to explain", type: "v.", category: "cat2", example_fr: "Peux-tu m'expliquer cette r√®gle de grammaire ?", example_en: "Can you explain this grammar rule to me?", audioUrl: null },
            { french: "imaginer", english: "to imagine", type: "v.", category: "cat2", example_fr: "Imaginez un monde sans voitures ni pollution.", example_en: "Imagine a world without cars or pollution.", audioUrl: null },
            { french: "oser", english: "to dare", type: "v.", category: "cat2", example_fr: "Personne n'ose contredire le directeur.", example_en: "No one dares to contradict the director.", audioUrl: null },
            { french: "para√Ætre", english: "to seem, appear", type: "v.", category: "cat2", example_fr: "Il para√Æt que le nouveau film est excellent.", example_en: "It appears that the new movie is excellent.", audioUrl: null },
            { french: "pr√©tendre", english: "to claim", type: "v.", category: "cat2", example_fr: "Elle pr√©tend √™tre la meilleure experte en la mati√®re.", example_en: "She claims to be the best expert on the subject.", audioUrl: null },
            { french: "pr√©voir", english: "to foresee, plan", type: "v.", category: "cat2", example_fr: "Ils pr√©voient de se marier cet √©t√©.", example_en: "They plan to get married this summer.", audioUrl: null },
            { french: "promettre", type: "v.", english: "to promise", category: "cat2", example_fr: "Je te promets de ne rien dire √† personne.", example_en: "I promise you not to tell anyone anything.", audioUrl: null },
            { french: "reconna√Ætre", english: "to recognize", type: "v.", category: "cat2", example_fr: "Je reconnais sa voix m√™me s'il parle doucement.", example_en: "I recognize his voice even if he speaks softly.", audioUrl: null },
            { french: "sembler", english: "to seem", type: "v.", category: "cat2", example_fr: "Il semble y avoir un probl√®me avec le syst√®me.", example_en: "There seems to be a problem with the system.", audioUrl: null },

            { french: "un/e adulte", english: "an adult", type: "n.m./f.", category: "cat3", example_fr: "Chaque adulte a le droit de voter.", example_en: "Every adult has the right to vote.", audioUrl: null },
            { french: "un/e citoyen/ne", english: "a citizen", type: "n.m./f.", category: "cat3", example_fr: "Les citoyens doivent respecter les lois.", example_en: "Citizens must respect the laws.", audioUrl: null },
            { french: "la foule", english: "the crowd", type: "n.f.", category: "cat3", example_fr: "La foule s'est rassembl√©e devant le b√¢timent.", example_en: "The crowd gathered in front of the building.", audioUrl: null },
            { french: "un/e √©tranger/√®re", english: "a stranger, foreigner", type: "n.m./f.", category: "cat3", example_fr: "Il est difficile d'√™tre un √©tranger dans un nouveau pays.", example_en: "It is difficult to be a foreigner in a new country.", audioUrl: null },
            { french: "le gouvernement", english: "the government", type: "n.m.", category: "cat3", example_fr: "Le gouvernement a annonc√© de nouvelles mesures √©conomiques.", example_en: "The government announced new economic measures.", audioUrl: null },
            { french: "un/e habitant/e", english: "an inhabitant", type: "n.m./f.", category: "cat3", example_fr: "Chaque habitant de la ville b√©n√©ficie des services publics.", example_en: "Each inhabitant of the city benefits from public services.", audioUrl: null },
            { french: "un individu", english: "an individual", type: "n.m.", category: "cat3", example_fr: "Chaque individu est unique et a des droits.", example_en: "Every individual is unique and has rights.", audioUrl: null },
            { french: "la jeunesse", english: "the youth", type: "n.f.", category: "cat3", example_fr: "Il faut investir dans la jeunesse pour l'avenir.", example_en: "We must invest in youth for the future.", audioUrl: null },
            { french: "un/e membre", english: "a member", type: "n.m./f.", category: "cat3", example_fr: "Il est un membre actif de cette association.", example_en: "He is an active member of this association.", audioUrl: null },
            { french: "la population", english: "the population", type: "n.f.", category: "cat3", example_fr: "La population mondiale ne cesse d'augmenter.", example_en: "The world population keeps increasing.", audioUrl: null },
            { french: "le public", english: "the public", type: "n.m.", category: "cat3", example_fr: "Le public a tr√®s bien accueilli la pi√®ce de th√©√¢tre.", example_en: "The public received the play very well.", audioUrl: null },
            { french: "une r√®gle", english: "a rule", type: "n.f.", category: "cat3", example_fr: "Il y a une r√®gle simple √† suivre : l'honn√™tet√©.", example_en: "There is one simple rule to follow: honesty.", audioUrl: null },
            { french: "la s√©curit√©", english: "security, safety", type: "n.f.", category: "cat3", example_fr: "La s√©curit√© des donn√©es est notre priorit√©.", example_en: "Data security is our priority.", audioUrl: null },
            { french: "la soci√©t√©", english: "society", type: "n.f.", category: "cat3", example_fr: "Nous vivons dans une soci√©t√© de consommation.", example_en: "We live in a consumer society.", audioUrl: null },
            { french: "un t√©moin", english: "a witness", type: "n.m.", category: "cat3", example_fr: "Un t√©moin a d√©crit l'accident √† la police.", example_en: "A witness described the accident to the police.", audioUrl: null },
            { french: "la violence", english: "violence", type: "n.f.", category: "cat3", example_fr: "Il faut lutter contre la violence sous toutes ses formes.", example_en: "We must fight against violence in all its forms.", audioUrl: null },
            { french: "un/e coll√®gue", english: "a colleague", type: "n.m./f.", category: "cat3", example_fr: "J'ai d√©jeun√© avec une coll√®gue aujourd'hui.", example_en: "I had lunch with a colleague today.", audioUrl: null },
            { french: "un/e responsable", english: "a person in charge", type: "n.m./f.", category: "cat3", example_fr: "Le responsable du projet n'√©tait pas l√†.", example_en: "The person in charge of the project was not there.", audioUrl: null },
            { french: "un/e sp√©cialiste", english: "a specialist", type: "n.m./f.", category: "cat3", example_fr: "J'ai consult√© un sp√©cialiste pour mon probl√®me de dos.", example_en: "I consulted a specialist for my back problem.", audioUrl: null },
            { french: "un/e voisin/e", english: "a neighbor", type: "n.m./f.", category: "cat3", example_fr: "Mon voisin m'a aid√© √† d√©m√©nager le canap√©.", example_en: "My neighbor helped me move the sofa.", audioUrl: null },

            { french: "un appareil", english: "a device, appliance", type: "n.m.", category: "cat4", example_fr: "Ce nouvel appareil photo est tr√®s performant.", example_en: "This new camera device is very powerful.", audioUrl: null },
            { french: "un b√¢timent", english: "a building", type: "n.m.", category: "cat4", example_fr: "C'est le plus haut b√¢timent de la ville.", example_en: "It is the tallest building in the city.", audioUrl: null },
            { french: "un bureau", english: "an office, desk", type: "n.m.", category: "cat4", example_fr: "Je travaille dans un petit bureau au centre-ville.", example_en: "I work in a small office downtown.", audioUrl: null },
            { french: "un coin", english: "a corner", type: "n.m.", category: "cat4", example_fr: "Le magasin est juste au coin de la rue.", example_en: "The store is right around the corner.", audioUrl: null },
            { french: "le droit", english: "the right, law", type: "n.m.", category: "cat4", example_fr: "Tout le monde a le droit √† une √©ducation gratuite.", example_en: "Everyone has the right to a free education.", audioUrl: null },
            { french: "une √©mission", english: "a broadcast, program", type: "n.f.", category: "cat4", example_fr: "Je regarde cette √©mission de cuisine tous les mercredis.", example_en: "I watch this cooking show every Wednesday.", audioUrl: null },
            { french: "un endroit", english: "a place", type: "n.m.", category: "cat4", example_fr: "J'ai trouv√© un endroit calme pour √©tudier.", example_en: "I found a quiet place to study.", audioUrl: null },
            { french: "une entreprise", english: "a company, business", type: "n.f.", category: "cat4", example_fr: "Il a cr√©√© son entreprise √† l'√¢ge de 25 ans.", example_en: "He started his company at the age of 25.", audioUrl: null },
            { french: "un √©quipement", english: "equipment", type: "n.m.", category: "cat4", example_fr: "Nous avons besoin de nouvel √©quipement sportif.", example_en: "We need new sports equipment.", audioUrl: null },
            { french: "un espace", english: "a space", type: "n.m.", category: "cat4", example_fr: "Il y a un grand espace vert devant la maison.", example_en: "There is a large green space in front of the house.", audioUrl: null },
            { french: "un exemple", english: "an example", type: "n.m.", category: "cat4", example_fr: "Pouvez-vous me donner un exemple de ce mot ?", example_en: "Can you give me an example of this word?", audioUrl: null },
            { french: "une fronti√®re", english: "a border", type: "n.f.", category: "cat4", example_fr: "Nous avons travers√© la fronti√®re hier soir.", example_en: "We crossed the border last night.", audioUrl: null },
            { french: "un lieu", english: "a place", type: "n.m.", category: "cat4", example_fr: "C'est un lieu magnifique pour passer les vacances.", example_en: "It is a magnificent place to spend the holidays.", audioUrl: null },
            { french: "un logement", english: "housing, accommodation", type: "n.m.", category: "cat4", example_fr: "Je cherche un logement √©tudiant pr√®s de l'universit√©.", example_en: "I am looking for student housing near the university.", audioUrl: null },
            { french: "un moyen", english: "a means, way", type: "n.m.", category: "cat4", example_fr: "Le train est le meilleur moyen de transport ici.", example_en: "The train is the best means of transport here.", audioUrl: null },
            { french: "un quartier", english: "a neighborhood", type: "n.m.", category: "cat4", example_fr: "J'habite dans un quartier tr√®s anim√©.", example_en: "I live in a very lively neighborhood.", audioUrl: null },
            { french: "un r√©seau", english: "a network", type: "n.m.", category: "cat4", example_fr: "Elle utilise son r√©seau professionnel pour trouver un emploi.", example_en: "She uses her professional network to find a job.", audioUrl: null },
            { french: "un service", english: "a service", type: "n.m.", category: "cat4", example_fr: "Le service √† la client√®le √©tait excellent.", example_en: "The customer service was excellent.", audioUrl: null },
            { french: "un site", english: "a site, website", type: "n.m.", category: "cat4", example_fr: "J'ai trouv√© l'information sur un site web fiable.", example_en: "I found the information on a reliable website.", audioUrl: null },
            { french: "le transport", english: "transportation", type: "n.m.", category: "cat4", example_fr: "Les co√ªts de transport ont augment√©.", example_en: "The transportation costs have increased.", audioUrl: null },

            { french: "un avis", english: "an opinion", type: "n.m.", category: "cat5", example_fr: "Quel est votre avis sur ce nouveau projet ?", example_en: "What is your opinion on this new project?", audioUrl: null },
            { french: "un but", english: "a goal, aim", type: "n.m.", category: "cat5", example_fr: "Son but est de voyager autour du monde.", example_en: "His goal is to travel around the world.", audioUrl: null },
            { french: "une cause", english: "a cause, reason", type: "n.f.", category: "cat5", example_fr: "Quelle est la cause principale de ce probl√®me ?", example_en: "What is the main cause of this problem?", audioUrl: null },
            { french: "une cons√©quence", english: "a consequence", type: "n.f.", category: "cat5", example_fr: "La s√©cheresse est une cons√©quence du changement climatique.", example_en: "Drought is a consequence of climate change.", audioUrl: null },
            { french: "la croissance", english: "growth", type: "n.f.", category: "cat5", example_fr: "Nous observons une forte croissance √©conomique cette ann√©e.", example_en: "We are observing strong economic growth this year.", audioUrl: null },
            { french: "une diff√©rence", english: "a difference", type: "n.f.", category: "cat5", example_fr: "Il y a une grande diff√©rence entre les deux propositions.", example_en: "There is a big difference between the two proposals.", audioUrl: null },
            { french: "une difficult√©", english: "a difficulty", type: "n.f.", category: "cat5", example_fr: "J'ai eu des difficult√©s √† comprendre les instructions.", example_en: "I had difficulties understanding the instructions.", audioUrl: null },
            { french: "un effort", english: "an effort", type: "n.m.", category: "cat5", example_fr: "Il a fait un gros effort pour terminer le travail √† temps.", example_en: "He made a big effort to finish the work on time.", audioUrl: null },
            { french: "une erreur", english: "an error, mistake", type: "n.f.", category: "cat5", example_fr: "J'ai commis une grave erreur dans mon calcul.", example_en: "I made a serious mistake in my calculation.", audioUrl: null },
            { french: "l'habitude (f)", english: "the habit", type: "n.f.", category: "cat5", example_fr: "J'ai l'habitude de boire du th√© le matin.", example_en: "I have the habit of drinking tea in the morning.", audioUrl: null },
            { french: "l'importance (f)", english: "importance", type: "n.f.", category: "cat5", example_fr: "Je comprends l'importance de ce document.", example_en: "I understand the importance of this document.", audioUrl: null },
            { french: "une influence", english: "an influence", type: "n.f.", category: "cat5", example_fr: "Son travail a eu une grande influence sur ma carri√®re.", example_en: "Her work had a great influence on my career.", audioUrl: null },
            { french: "une information", english: "a piece of information", type: "n.f.", category: "cat5", example_fr: "J'ai besoin de cette information pour mon rapport.", example_en: "I need this piece of information for my report.", audioUrl: null },
            { french: "la libert√©", english: "freedom, liberty", type: "n.f.", category: "cat5", example_fr: "Ils se sont battus pour leur libert√©.", example_en: "They fought for their freedom.", audioUrl: null },
            { french: "la m√©moire", english: "memory", type: "n.f.", category: "cat5", example_fr: "Il a une excellente m√©moire pour les dates.", example_en: "He has an excellent memory for dates.", audioUrl: null },
            { french: "la moiti√©", english: "the half", type: "n.f.", category: "cat5", example_fr: "Il a mang√© la moiti√© du g√¢teau.", example_en: "He ate half of the cake.", audioUrl: null },
            { french: "un objectif", english: "an objective, goal", type: "n.m.", category: "cat5", example_fr: "L'objectif principal est d'am√©liorer la qualit√©.", example_en: "The main objective is to improve quality.", audioUrl: null },
            { french: "la paix", english: "peace", type: "n.f.", category: "cat5", example_fr: "Nous souhaitons la paix dans le monde.", example_en: "We wish for peace in the world.", audioUrl: null },
            { french: "la plupart", english: "the majority, most", type: "n.f.", category: "cat5", example_fr: "La plupart des √©tudiants sont d√©j√† partis.", example_en: "Most of the students have already left.", audioUrl: null },
            { french: "un risque", english: "a risk", type: "n.m.", category: "cat5", example_fr: "Ce projet comporte un risque financier.", example_en: "This project involves a financial risk.", audioUrl: null },

            { french: "actuel/le", english: "current", type: "adj.", category: "cat6", example_fr: "Quelle est la situation actuelle de l'entreprise ?", example_en: "What is the current situation of the company?", audioUrl: null },
            { french: "ancien/ne", english: "ancient, former", type: "adj.", category: "cat6", example_fr: "Ce b√¢timent ancien est un monument historique.", example_en: "This ancient building is a historical monument.", audioUrl: null },
            { french: "bas/se", english: "low", type: "adj.", category: "cat6", example_fr: "Le prix du p√©trole est tr√®s bas en ce moment.", example_en: "The price of oil is very low right now.", audioUrl: null },
            { french: "capable", english: "capable, able", type: "adj.", category: "cat6", example_fr: "Je suis capable de le faire tout seul.", example_en: "I am capable of doing it by myself.", audioUrl: null },
            { french: "certain/e", english: "certain, sure", type: "adj.", category: "cat6", example_fr: "Je suis certain qu'elle va r√©ussir son examen.", example_en: "I am sure she will pass her exam.", audioUrl: null },
            { french: "clair/e", english: "clear, light", type: "adj.", category: "cat6", example_fr: "Les instructions doivent √™tre claires et pr√©cises.", example_en: "The instructions must be clear and precise.", audioUrl: null },
            { french: "diff√©rent/e", english: "different", type: "adj.", category: "cat6", example_fr: "Nous avons tous des opinions diff√©rentes.", example_en: "We all have different opinions.", audioUrl: null },
            { french: "dur/e", english: "hard, difficult", type: "adj.", category: "cat6", example_fr: "C'√©tait une journ√©e de travail longue et dure.", example_en: "It was a long and hard day of work.", audioUrl: null },
            { french: "efficace", english: "effective, efficient", type: "adj.", category: "cat6", example_fr: "Cette m√©thode est la plus efficace pour apprendre.", example_en: "This method is the most effective for learning.", audioUrl: null },
            { french: "entier/√®re", english: "entire, whole", type: "adj.", category: "cat6", example_fr: "J'ai lu le livre entier en une seule soir√©e.", example_en: "I read the entire book in one evening.", audioUrl: null },
            { french: "√©trange", english: "strange", type: "adj.", category: "cat6", example_fr: "Il s'est pass√© quelque chose de tr√®s √©trange hier.", example_en: "Something very strange happened yesterday.", audioUrl: null },
            { french: "fort/e", english: "strong", type: "adj.", category: "cat6", example_fr: "Il faut une volont√© forte pour r√©ussir ce r√©gime.", example_en: "One needs a strong will to succeed with this diet.", audioUrl: null },
            { french: "grave", english: "serious", type: "adj.", category: "cat6", example_fr: "C'est un probl√®me grave qui n√©cessite une attention imm√©diate.", example_en: "It is a serious problem that requires immediate attention.", audioUrl: null },
            { french: "humain/e", english: "human", type: "adj.", category: "cat6", example_fr: "Chaque √™tre humain a droit au respect.", example_en: "Every human being has the right to respect.", audioUrl: null },
            { french: "international/e", english: "international", type: "adj.", category: "cat6", example_fr: "Ils travaillent dans une organisation internationale.", audioUrl: null },
            { french: "l√©ger/√®re", english: "light (weight)", type: "adj.", category: "cat6", example_fr: "Je n'ai pris qu'un repas l√©ger √† midi.", example_en: "I only had a light meal at noon.", audioUrl: null },
            { french: "lourd/e", english: "heavy", type: "adj.", category: "cat6", example_fr: "Cette valise est trop lourde pour √™tre port√©e.", example_en: "This suitcase is too heavy to be carried.", audioUrl: null },
            { french: "nombreux/euses", english: "numerous", type: "adj.", category: "cat6", example_fr: "De nombreuses personnes √©taient pr√©sentes √† la c√©r√©monie.", example_en: "Numerous people were present at the ceremony.", audioUrl: null },
            { french: "principal/e", english: "main, principal", type: "adj.", category: "cat6", example_fr: "Le sujet principal de la discussion √©tait l'√©conomie.", example_en: "The main subject of the discussion was the economy.", audioUrl: null },
            { french: "public/publique", english: "public", type: "adj.", category: "cat6", example_fr: "Cette information est d√©j√† publique, tout le monde la conna√Æt.", example_en: "This information is already public, everyone knows it.", audioUrl: null },

            { french: "agr√©able", english: "pleasant", type: "adj.", category: "cat7", example_fr: "Nous avons pass√© un moment tr√®s agr√©able ensemble.", example_en: "We had a very pleasant time together.", audioUrl: null },
            { french: "content/e", english: "happy, pleased", type: "adj.", category: "cat7", example_fr: "Il est tr√®s content de son nouveau travail.", example_en: "He is very happy with his new job.", audioUrl: null },
            { french: "d√©√ßu/e", english: "disappointed", type: "adj.", category: "cat7", example_fr: "J'√©tais vraiment d√©√ßu de la qualit√© du service.", example_en: "I was really disappointed with the quality of the service.", audioUrl: null },
            { french: "dr√¥le", english: "funny", type: "adj.", category: "cat7", example_fr: "Il a racont√© une histoire tr√®s dr√¥le.", example_en: "He told a very funny story.", audioUrl: null },
            { french: "√©tonnant/e", english: "astonishing, surprising", type: "adj.", category: "cat7", example_fr: "Le r√©sultat de l'√©lection est √©tonnant.", example_en: "The result of the election is astonishing.", audioUrl: null },
            { french: "fier/fi√®re", english: "proud", type: "adj.", category: "cat7", example_fr: "Elle est tr√®s fi√®re de la r√©ussite de ses enfants.", example_en: "She is very proud of her children's success.", audioUrl: null },
            { french: "heureux/euse", type: "adj.", english: "happy", category: "cat7", example_fr: "Je suis heureux de te revoir apr√®s tout ce temps.", example_en: "I am happy to see you again after all this time.", audioUrl: null },
            { french: "inquiet/√®te", english: "worried", type: "adj.", category: "cat7", example_fr: "Je suis inquiet pour l'avenir de la plan√®te.", example_en: "I am worried about the future of the planet.", audioUrl: null },
            { french: "jaloux/ouse", english: "jealous", type: "adj.", category: "cat7", example_fr: "Mon petit fr√®re est jaloux de ma nouvelle console de jeux.", example_en: "My little brother is jealous of my new game console.", audioUrl: null },
            { french: "juste", english: "fair, just", type: "adj.", category: "cat7", example_fr: "Sa d√©cision me semble juste et √©quilibr√©e.", example_en: "His decision seems fair and balanced to me.", audioUrl: null },
            { french: "libre", english: "free", type: "adj.", category: "cat7", example_fr: "Je suis enfin libre de faire ce que je veux.", example_en: "I am finally free to do what I want.", audioUrl: null },
            { french: "malade", english: "sick", type: "adj.", category: "cat7", example_fr: "Il est rest√© √† la maison car il √©tait malade.", example_en: "He stayed home because he was sick.", audioUrl: null },
            { french: "mauvais/e", english: "bad", type: "adj.", category: "cat7", example_fr: "J'ai eu une tr√®s mauvaise journ√©e aujourd'hui.", example_en: "I had a very bad day today.", audioUrl: null },
            { french: "meilleur/e", english: "better, best", type: "adj.", category: "cat7", example_fr: "C'est le meilleur restaurant de la ville.", example_en: "It is the best restaurant in the city.", audioUrl: null },
            { french: "pauvre", english: "poor", type: "adj.", category: "cat7", example_fr: "Il est difficile de vivre quand on est pauvre.", example_en: "It is difficult to live when one is poor.", audioUrl: null },
            { french: "pr√™t/e", english: "ready", type: "adj.", category: "cat7", example_fr: "√ätes-vous pr√™t pour le voyage de demain ?", example_en: "Are you ready for tomorrow's trip?", audioUrl: null },
            { french: "riche", english: "rich", type: "adj.", category: "cat7", example_fr: "Il a √©pous√© une femme tr√®s riche.", example_en: "He married a very rich woman.", audioUrl: null },
            { french: "surpris/e", english: "surprised", type: "adj.", category: "cat7", example_fr: "J'√©tais tr√®s surpris de le voir ici.", example_en: "I was very surprised to see him here.", audioUrl: null },
            { french: "triste", english: "sad", type: "adj.", category: "cat7", example_fr: "Elle √©tait tr√®s triste apr√®s la mauvaise nouvelle.", example_en: "She was very sad after the bad news.", audioUrl: null },
            { french: "utile", english: "useful", type: "adj.", category: "cat7", example_fr: "Cet outil est tr√®s utile pour mon travail.", example_en: "This tool is very useful for my work.", audioUrl: null },

            { french: "ailleurs", english: "elsewhere", type: "adv.", category: "cat8", example_fr: "Je n'ai pas trouv√© mes cl√©s ici, elles doivent √™tre ailleurs.", example_en: "I didn't find my keys here, they must be elsewhere.", audioUrl: null },
            { french: "ainsi", english: "thus, so", type: "adv.", category: "cat8", example_fr: "Il a refus√© l'offre, agissant ainsi contre son int√©r√™t.", example_en: "He refused the offer, thus acting against his interest.", audioUrl: null },
            { french: "autant", english: "as much, as many", type: "adv.", category: "cat8", example_fr: "J'ai autant d'amis que toi.", example_en: "I have as many friends as you.", audioUrl: null },
            { french: "autrefois", english: "formerly, in the past", type: "adv.", category: "cat8", example_fr: "Autrefois, il n'y avait pas de t√©l√©phones portables.", example_en: "In the past, there were no cell phones.", audioUrl: null },
            { french: "cependant", english: "however", type: "adv.", category: "cat8", example_fr: "J'ai faim ; cependant, je ne veux pas cuisiner.", example_en: "I'm hungry; however, I don't want to cook.", audioUrl: null },
            { french: "d'abord", english: "firstly, at first", type: "adv.", category: "cat8", example_fr: "D'abord, m√©langez les ≈ìufs et le sucre.", example_en: "Firstly, mix the eggs and the sugar.", audioUrl: null },
            { french: "ensuite", english: "next, then", type: "adv.", category: "cat8", example_fr: "Nous irons au mus√©e, et ensuite nous d√Ænerons.", example_en: "We will go to the museum, and then we will have dinner.", audioUrl: null },
            { french: "environ", english: "approximately", type: "adv.", category: "cat8", example_fr: "Il y avait environ cinquante personnes √† la f√™te.", example_en: "There were approximately fifty people at the party.", audioUrl: null },
            { french: "jamais", english: "never", type: "adv.", category: "cat8", example_fr: "Je ne l'ai jamais vu sourire.", example_en: "I have never seen him smile.", audioUrl: null },
            { french: "longtemps", english: "for a long time", type: "adv.", category: "cat8", example_fr: "Nous avons attendu longtemps dans le froid.", example_en: "We waited for a long time in the cold.", audioUrl: null },
            { french: "maintenant", english: "now", type: "adv.", category: "cat8", example_fr: "Je ne suis pas libre maintenant, mais plus tard.", example_en: "I am not free now, but later.", audioUrl: null },
            { french: "parfois", english: "sometimes", type: "adv.", category: "cat8", example_fr: "Il est parfois difficile de prendre une d√©cision.", example_en: "It is sometimes difficult to make a decision.", audioUrl: null },
            { french: "partout", english: "everywhere", type: "adv.", category: "cat8", example_fr: "Nous avons cherch√© le chat partout dans la maison.", example_en: "We looked for the cat everywhere in the house.", audioUrl: null },
            { french: "pendant", english: "during", type: "prep.", category: "cat8", example_fr: "Elle a dormi pendant tout le voyage.", example_en: "She slept during the whole trip.", audioUrl: null },
            { french: "pourtant", english: "yet, however", type: "adv.", category: "cat8", example_fr: "Il √©tait fatigu√©, pourtant il a continu√© √† travailler.", example_en: "He was tired, yet he continued to work.", audioUrl: null },
            { french: "r√©cemment", english: "recently", type: "adv.", category: "cat8", example_fr: "J'ai r√©cemment achet√© une nouvelle voiture.", example_en: "I recently bought a new car.", audioUrl: null },
            { french: "soudain", english: "suddenly", type: "adv.", category: "cat8", example_fr: "Soudain, la lumi√®re s'est √©teinte.", example_en: "Suddenly, the light went out.", audioUrl: null },
            { french: "surtout", english: "especially, above all", type: "adv.", category: "cat8", example_fr: "J'aime la cuisine italienne, surtout les pizzas.", example_en: "I like Italian cuisine, especially pizzas.", audioUrl: null },
            { french: "toujours", english: "always, still", type: "adv.", category: "cat8", example_fr: "Elle est toujours en retard.", example_en: "She is always late.", audioUrl: null },
            { french: "vraiment", english: "really, truly", type: "adv.", category: "cat8", example_fr: "C'est un film vraiment exceptionnel.", example_en: "It is a truly exceptional movie.", audioUrl: null },

            { french: "afin de", english: "in order to", type: "conj.", category: "cat9", example_fr: "Je travaille dur afin de r√©ussir mon examen.", example_en: "I work hard in order to pass my exam.", audioUrl: null },
            { french: "√† travers", english: "through, across", type: "prep.", category: "cat9", example_fr: "Nous avons voyag√© √† travers la France.", example_en: "We traveled across France.", audioUrl: null },
            { french: "car", english: "because, for", type: "conj.", category: "cat9", example_fr: "Elle a manqu√© le bus car elle s'est lev√©e tard.", example_en: "She missed the bus because she woke up late.", audioUrl: null },
            { french: "c'est-√†-dire", english: "that is to say", type: "expr.", category: "cat9", example_fr: "Il est v√©g√©tarien, c'est-√†-dire qu'il ne mange pas de viande.", example_en: "He is vegetarian, that is to say, he doesn't eat meat.", audioUrl: null },
            { french: "contre", english: "against", type: "prep.", category: "cat9", example_fr: "Il a vot√© contre la nouvelle loi.", example_en: "He voted against the new law.", audioUrl: null },
            { french: "depuis", english: "since, for (time)", type: "prep.", category: "cat9", example_fr: "J'√©tudie le fran√ßais depuis trois ans.", example_en: "I have been studying French for three years.", audioUrl: null },
            { french: "d√®s que", english: "as soon as", type: "conj.", category: "cat9", example_fr: "Je t'appellerai d√®s que j'arriverai √† la gare.", example_en: "I will call you as soon as I arrive at the station.", audioUrl: null },
            { french: "donc", english: "so, therefore", type: "conj.", category: "cat9", example_fr: "Il a plu, donc nous avons annul√© le pique-nique.", example_en: "It rained, so we canceled the picnic.", audioUrl: null },
            { french: "lorsque", english: "when", type: "conj.", category: "cat9", example_fr: "Appelez-moi lorsque vous serez pr√™t.", example_en: "Call me when you are ready.", audioUrl: null },
            { french: "mais", english: "but", type: "conj.", category: "cat9", example_fr: "Le film √©tait long, mais tr√®s int√©ressant.", example_en: "The movie was long, but very interesting.", audioUrl: null },
            { french: "malgr√©", english: "despite", type: "prep.", category: "cat9", example_fr: "Malgr√© la pluie, nous sommes all√©s nous promener.", example_en: "Despite the rain, we went for a walk.", audioUrl: null },
            { french: "n√©anmoins", english: "nevertheless", type: "adv.", category: "cat9", example_fr: "Il est tr√®s fatigu√©, n√©anmoins il continue de travailler.", example_en: "He is very tired, nevertheless he continues to work.", audioUrl: null },
            { french: "ou", english: "or", type: "conj.", category: "cat9", example_fr: "Voulez-vous du th√© ou du caf√© ?", example_en: "Do you want tea or coffee?", audioUrl: null },
            { french: "parmi", english: "among", type: "prep.", category: "cat9", example_fr: "Il y avait beaucoup de livres, parmi lesquels j'ai choisi un roman.", example_en: "There were many books, among which I chose a novel.", audioUrl: null },
            { french: "gr√¢ce √†", english: "thanks to", type: "prep.", category: "cat9", example_fr: "Il a r√©ussi gr√¢ce √† son travail acharn√©.", example_en: "He succeeded thanks to his hard work.", audioUrl: null },
            { french: "√† cause de", english: "because of", type: "prep.", category: "cat9", example_fr: "Le match a √©t√© report√© √† cause de la neige.", example_en: "The match was postponed because of the snow.", audioUrl: null },
            { french: "selon", english: "according to", type: "prep.", category: "cat9", example_fr: "Selon les experts, le temps va s'am√©liorer.", example_en: "According to the experts, the weather will improve.", audioUrl: null },
            { french: "sauf", english: "except", type: "prep.", category: "cat9", example_fr: "Tout le monde est venu, sauf Marie.", example_en: "Everyone came, except Marie.", audioUrl: null },
            { french: "tandis que", english: "whereas, while", type: "conj.", category: "cat9", example_fr: "Elle aime la mer, tandis que son fr√®re pr√©f√®re la montagne.", example_en: "She loves the sea, whereas her brother prefers the mountains.", audioUrl: null },
            { french: "vers", english: "towards, around", type: "prep.", category: "cat9", example_fr: "Nous nous dirigeons vers la sortie maintenant.", example_en: "We are heading towards the exit now.", audioUrl: null },

            { french: "l'avenir (m)", english: "the future", type: "n.m.", category: "cat10", example_fr: "Que ferez-vous dans l'avenir ?", example_en: "What will you do in the future?", audioUrl: null },
            { french: "le changement", english: "change", type: "n.m.", category: "cat10", example_fr: "Nous avons besoin d'un changement dans cette politique.", example_en: "We need a change in this policy.", audioUrl: null },
            { french: "le climat", english: "climate", type: "n.m.", category: "cat10", example_fr: "Le climat est tr√®s agr√©able dans le sud de l'Espagne.", example_en: "The climate is very pleasant in the south of Spain.", audioUrl: null },
            { french: "la communication", english: "communication", type: "n.f.", category: "cat10", example_fr: "La communication est essentielle en √©quipe.", example_en: "Communication is essential in a team.", audioUrl: null },
            { french: "la consommation", english: "consumption", type: "n.f.", category: "cat10", example_fr: "Il faut r√©duire notre consommation d'√©nergie.", example_en: "We must reduce our energy consumption.", audioUrl: null },
            { french: "l'√©nergie (f)", english: "energy", type: "n.f.", category: "cat10", example_fr: "Le soleil est une source d'√©nergie renouvelable.", example_en: "The sun is a source of renewable energy.", audioUrl: null },
            { french: "l'environnement (m)", english: "the environment", type: "n.m.", category: "cat10", example_fr: "Nous devons prot√©ger l'environnement pour les g√©n√©rations futures.", example_en: "We must protect the environment for future generations.", audioUrl: null },
            { french: "la plan√®te", english: "the planet", type: "n.f.", category: "cat10", example_fr: "La plan√®te est notre maison commune.", example_en: "The planet is our common home.", audioUrl: null },
            { french: "la pollution", english: "pollution", type: "n.f.", category: "cat10", example_fr: "La pollution de l'air est un probl√®me majeur.", example_en: "Air pollution is a major problem.", audioUrl: null },
            { french: "un produit", english: "a product", type: "n.m.", category: "cat10", example_fr: "C'est un produit fabriqu√© en France.", example_en: "It is a product manufactured in France.", audioUrl: null },
            { french: "le progr√®s", english: "progress", type: "n.m.", category: "cat10", example_fr: "Nous avons fait de grands progr√®s cette ann√©e.", example_en: "We have made great progress this year.", audioUrl: null },
            { french: "la protection", english: "protection", type: "n.f.", category: "cat10", example_fr: "La protection des donn√©es est tr√®s importante.", example_en: "Data protection is very important.", audioUrl: null },
            { french: "la recherche", english: "research", type: "n.f.", category: "cat10", example_fr: "Il travaille dans la recherche scientifique.", example_en: "He works in scientific research.", audioUrl: null },
            { french: "une ressource", english: "a resource", type: "n.f.", category: "cat10", example_fr: "L'eau est une ressource naturelle pr√©cieuse.", example_en: "Water is a precious natural resource.", audioUrl: null },
            { french: "la sant√©", english: "health", type: "n.f.", category: "cat10", example_fr: "Faire du sport est bon pour la sant√©.", example_en: "Doing sport is good for your health.", audioUrl: null },
            { french: "la science", english: "science", type: "n.f.", category: "cat10", example_fr: "La science nous aide √† comprendre le monde.", example_en: "Science helps us understand the world.", audioUrl: null },
            { french: "un syst√®me", english: "a system", type: "n.m.", category: "cat10", example_fr: "Le syst√®me de chauffage est en panne.", example_en: "The heating system is broken down.", audioUrl: null },
            { french: "la Terre", english: "Earth, ground", type: "n.f.", category: "cat10", example_fr: "La temp√©rature sur la Terre augmente.", example_en: "The temperature on Earth is rising.", audioUrl: null },
            { french: "la vitesse", english: "speed", type: "n.f.", category: "cat10", example_fr: "La voiture roulait √† grande vitesse.", example_en: "The car was driving at high speed.", audioUrl: null },
            { french: "une voiture", english: "a car", type: "n.f.", category: "cat10", example_fr: "J'ai achet√© une nouvelle voiture rouge.", example_en: "I bought a new red car.", audioUrl: null }
        ];

        let currentDeck = [...masterDeck];
        let currentIndex = 0;
        let isFlipped = false;
        let audio;

        const cardContainer = document.getElementById('flashcard-container');
        const cardFrontText = document.getElementById('card-front-text');
        const cardBackText = document.getElementById('card-back-text');
        const cardTypeText = document.getElementById('card-type-text');
        const exampleFr = document.getElementById('example-fr');
        const exampleEn = document.getElementById('example-en');
        const progressIndicator = document.getElementById('progress-indicator');
        const categorySelect = document.getElementById('category-select');
        const playButton = document.getElementById('play-button');
        const loadingIndicator = document.getElementById('loading-indicator');
        const prevButton = document.getElementById('prev-button');
        const nextButton = document.getElementById('next-button');
        const flipButton = document.getElementById('flip-button');
        const shuffleButton = document.getElementById('shuffle-button');

        function updateCard() {
            if (currentDeck.length === 0) {
                cardFrontText.textContent = "Aucune carte";
                cardBackText.textContent = "";
                cardTypeText.textContent = "";
                exampleFr.textContent = "Veuillez choisir une autre cat√©gorie.";
                exampleEn.textContent = "Please choose another category.";
                playButton.disabled = true;
                updateProgress();
                return;
            }
            const card = currentDeck[currentIndex];
            cardFrontText.textContent = card.french;
            cardBackText.textContent = card.english;
            cardTypeText.textContent = card.type;
            exampleFr.textContent = card.example_fr;
            exampleEn.textContent = `(${card.example_en})`;
            playButton.disabled = false;

            if (isFlipped) {
                flipCard(true);
            }
            updateProgress();
        }

        function updateProgress() {
            const total = currentDeck.length;
            const current = total > 0 ? currentIndex + 1 : 0;
            progressIndicator.textContent = `Carte ${current} sur ${total}`;
        }

        function flipCard(forceFront = false) {
            if (isFlipped && !forceFront) {
                 // Do nothing if already flipped and not forced to front
            } else if (forceFront) {
                cardContainer.classList.remove('is-flipped');
                isFlipped = false;
            } else {
                cardContainer.classList.toggle('is-flipped');
                isFlipped = !isFlipped;
            }
        }

        function handleCardClick(event) {
            // Only flip if the click is not on the play button
            if (event.target !== playButton && !playButton.contains(event.target)) {
                flipCard(false);
            }
        }

        function nextCard() {
            if (currentDeck.length === 0) return;
            currentIndex = (currentIndex + 1) % currentDeck.length;
            updateCard();
        }

        function prevCard() {
            if (currentDeck.length === 0) return;
            currentIndex = (currentIndex - 1 + currentDeck.length) % currentDeck.length;
            updateCard();
        }

        function shuffleDeck() {
            for (let i = currentDeck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [currentDeck[i], currentDeck[j]] = [currentDeck[j], currentDeck[i]];
            }
            currentIndex = 0;
            updateCard();
        }

        function filterDeck() {
            const category = categorySelect.value;
            if (category === 'all') {
                currentDeck = [...masterDeck];
            } else {
                currentDeck = masterDeck.filter(card => card.category === category);
            }
            currentIndex = 0;
            updateCard();
        }

        // --- TTS & Audio Playback Functions ---

        function base64ToArrayBuffer(base64) {
            const binaryString = atob(base64);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes.buffer;
        }

        function pcmToWav(pcm16, sampleRate) {
            const numChannels = 1;
            const bytesPerSample = 2;
            const blockAlign = numChannels * bytesPerSample;
            const byteRate = sampleRate * blockAlign;
            const dataSize = pcm16.length * bytesPerSample;

            const buffer = new ArrayBuffer(44 + dataSize);
            const view = new DataView(buffer);

            let offset = 0;

            // RIFF chunk
            writeString('RIFF', view, offset); offset += 4;
            view.setUint32(offset, 36 + dataSize, true); offset += 4;
            writeString('WAVE', view, offset); offset += 4;

            // FMT chunk
            writeString('fmt ', view, offset); offset += 4;
            view.setUint32(offset, 16, true); offset += 4; // Sub-chunk size
            view.setUint16(offset, 1, true); offset += 2; // Audio format (1 for PCM)
            view.setUint16(offset, numChannels, true); offset += 2; // Number of channels
            view.setUint32(offset, sampleRate, true); offset += 4; // Sample rate
            view.setUint32(offset, byteRate, true); offset += 4; // Byte rate
            view.setUint16(offset, blockAlign, true); offset += 2; // Block align
            view.setUint16(offset, 16, true); offset += 2; // Bits per sample

            // DATA chunk
            writeString('data', view, offset); offset += 4;
            view.setUint32(offset, dataSize, true); offset += 4;

            // Write PCM data
            for (let i = 0; i < pcm16.length; i++, offset += 2) {
                view.setInt16(offset, pcm16[i], true);
            }

            return new Blob([buffer], { type: 'audio/wav' });
        }

        function writeString(s, view, offset) {
            for (let i = 0; i < s.length; i++) {
                view.setUint8(offset + i, s.charCodeAt(i));
            }
        }

        async function fetchAudio(text, retryCount = 0) {
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: `Say in French: ${text}` }] }],
                generationConfig: {
                    responseModalities: ["AUDIO"],
                    speechConfig: {
                        voiceConfig: {
                            prebuiltVoiceConfig: { voiceName: "Kore" }
                        }
                    }
                },
                model: "gemini-2.5-flash-preview-tts"
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`API Error: ${response.status} - ${errorText}`);
                }

                const result = await response.json();
                const part = result?.candidates?.[0]?.content?.parts?.[0];
                const audioData = part?.inlineData?.data;
                const mimeType = part?.inlineData?.mimeType;

                if (audioData && mimeType && mimeType.startsWith("audio/L16")) {
                    const match = mimeType.match(/rate=(\d+)/);
                    const sampleRate = match ? parseInt(match[1], 10) : 16000;

                    const pcmData = base64ToArrayBuffer(audioData);
                    const pcm16 = new Int16Array(pcmData);
                    const wavBlob = pcmToWav(pcm16, sampleRate);
                    return URL.createObjectURL(wavBlob);
                }
                throw new Error("Invalid audio response format from TTS API.");

            } catch (error) {
                if (retryCount < 3) {
                    const delay = Math.pow(2, retryCount) * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                    return fetchAudio(text, retryCount + 1);
                } else {
                    console.error("Failed to fetch audio after multiple retries:", error);
                    throw new Error("Impossible de g√©n√©rer l'audio apr√®s plusieurs tentatives.");
                }
            }
        }

        async function playCurrentWord(e) {
            if (e) e.stopPropagation();
            const card = currentDeck[currentIndex];

            if (audio && !audio.paused) {
                audio.pause();
                audio.currentTime = 0;
            }

            if (card.audioUrl) {
                audio = new Audio(card.audioUrl);
                audio.play();
                return;
            }

            loadingIndicator.classList.remove('hidden');
            playButton.disabled = true;

            try {
                const audioUrl = await fetchAudio(card.french);
                card.audioUrl = audioUrl; // Cache the URL
                
                audio = new Audio(audioUrl);
                audio.play();

            } catch (error) {
                console.error(error.message);
                alert("Erreur de lecture: " + error.message);
            } finally {
                loadingIndicator.classList.add('hidden');
                playButton.disabled = false;
            }
        }

        // --- Event Listeners ---

        prevButton.addEventListener('click', prevCard);
        nextButton.addEventListener('click', nextCard);
        flipButton.addEventListener('click', () => flipCard(false));
        shuffleButton.addEventListener('click', shuffleDeck);
        categorySelect.addEventListener('change', filterDeck);

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') {
                nextCard();
            } else if (e.key === 'ArrowLeft') {
                prevCard();
            } else if (e.key === ' ') {
                e.preventDefault();
                flipCard(false);
            }
        });

        // Initialize the app
        updateCard();
    </script>
</body>
</html>
